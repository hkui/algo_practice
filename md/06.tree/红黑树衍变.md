参考

https://www.cnblogs.com/tiancai/p/9072813.html


http://www.360doc.com/content/18/0904/19/25944647_783893127.shtml

红黑树的起源，自然是二叉查找树了，这种树结构从根节点开始，左子节点小于它，右子节点大于它。每个节点都符合这个特性，所以易于查找，是一种很好的数据结构。    
但是它有一个问题，就是容易偏向某一侧，这样就退化成一个链表结构了，失去了树结构的优点，查找时间会变坏
![](https://note.youdao.com/yws/api/personal/file/0CA39802B57F42A38554E9DCD09248D0?method=download&shareKey=6e20fe63d40943770c4e0bac08e3f33e)

这种需求下，平衡二叉树就产生了

红黑树就是一种平衡树，它可以保证二叉树基本符合矮矮胖胖的结构，但是理解红黑树之前，必须先了解另一种树，叫2-3树，红黑树背后的逻辑就是它

 ##### 2-3树是二叉查找树的变种，树中的2和3代表两种节点，以下表示为2-节点和3-节点
* 2-节点即普通节点：包含一个元素，两条子链接
* 3-节点则是扩充版，包含2个元素和三条链接：两个元素A、B，左边的链接指向小于A的节点，中间的链接指向介于A、B值之间的节点，右边的链接指向大于B的节点

![](https://note.youdao.com/yws/api/personal/file/EC5641253C2645A59CDCDEB16C3B3111?method=download&shareKey=4f3288027156f61d8daec3266521b90f)

在这两种节点的配合下，2-3树可以保证在插入值过程中，任意叶子节点到根节点的距离都是相同的。完全实现了矮胖矮胖的目标。怎么配合的呢，下面来看2-3树的构造过程。

所谓构造，就是从零开始一个节点一个节点的插入。

在二叉查找树中，插入过程从根节点开始比较，小于节点值往右继续与左子节点比，大于则继续与右子节点比，直到某节点左或右子节点为空，把值插入进去。这样无法避免偏向问题。

### 在2-3树中，插入的过程

#### 如果将值插入一个2-节点，则将2-节点扩充为一个3-节点
![](https://note.youdao.com/yws/api/personal/file/ED1364B6E8EE48A9B1EDB0899A93FB61?method=download&shareKey=c1ff549dcedeae9c4b1aad85149d0bde)


#### 如果将值插入一个3-节点，分为以下几种情况

* (1) 3-节点没有父节点，即整棵树就只有它一个3三节点  
 此时，将3-节点扩充为一个4-节点，即包含三个元素的节点，然后将其分解，变成一棵二叉树

![](https://note.youdao.com/yws/api/personal/file/5BCC14029B3D4201BE85E6FB4FC4C124?method=download&shareKey=6f895a9472471a3dd959f161af7a53a6)

此时二叉树依然保持平衡

* (2)3-节点有一个2-节点的父节点，此时的操作是，3-节点扩充为4-节点，然后分解4-节点，然后将分解后的新树的父节点融入到2-节点的父节点中去

![](https://note.youdao.com/yws/api/personal/file/DABE06A336684C7EBCF1F3C63C09D7CA?method=download&shareKey=b3b937d5d48fb352ad47f50c1822fc45)
 * (3)3-节点有一个3-节点的父节点，此时操作是：     3-节点扩充为4-节点，然后分解4-节点，新树父节点向上融合，上面的3-节点继续扩充，融合，分解，新树继续向上融合，直到父节点为2-节点为止，如果向上到根节点都是3-节点，将根节点扩充为4-节点，然后分解为新树，至此，整个树增加一层，仍然保持平衡。

  > 第三种情况稍微复杂点，为了便于直观理解，现在我们从零开始构建2-3树，囊括上面所有的情况

  > 我们将{7,8,9,10,11,12}中的数值依次插入2-3树，画出它的过程
  
  ![](https://note.youdao.com/yws/api/personal/file/90DD4A8CE482490397D8F92A8D6FF707?method=download&shareKey=abe10d88a629442d1505ab2813acc2a1)
  
  所以，2-3树的设计完全可以保证二叉树保持矮矮胖胖的状态，保持其性能良好。但是，将这种直白的表述写成代码实现起来并不方便，因为要处理的情况太多。这样需要维护两种不同类型的节点，将链接和其他信息从一个节点复制到另一个节点，将节点从一种类型转换为另一种类型等等。

  因此，红黑树出现了，红黑树的背后逻辑就是2-3树的逻辑，但是由于用红黑作为标记这个小技巧，最后实现的代码量并不大   
  (但是，要直接理解这些代码是如何工作的以及背后的道理，就比较困难了。所以你一定要理解它的演化过程，才能真正的理解红黑树)

  我们来看看红黑树和2-3树的关联     
  首先，最台面上的问题，红和黑的含义。  
  红黑树中，所有的节点都是标准的2-节点，为了体现出3-节点，这里将3-节点的两个元素用左斜红色的链接连接起来，即连接了两个2-节点来表示一个3-节点。    
  这里红色节点标记就代表指向其的链接是红链接，黑色标记的节点就是普通的节点。所以才会有那样一条定义，叫“从任一节点到其每个叶子的所有简单路径都包含相同数目的黑色节点”，因为红色节点是可以与其父节点合并为一个3-节点的，**红黑树实现的其实是一个完美的黑色平衡**，如果你将红黑树中所有的红色链接放平，那么它所有的叶子节点到根节点的距离都是相同的。所以它并不是一个严格的平衡二叉树，但是它的综合性能已经很优秀了
  
  ![](https://note.youdao.com/yws/api/personal/file/F57EE3835DA6429E95A34ADF43358790?method=download&shareKey=1adc49d08b3c068511829ea66fc6f7a9)
  ##### 红链接只能是左链接，且由于a小于b,故b在上为a的父节点
  
  #### 红链接放平
  ![](https://note.youdao.com/yws/api/personal/file/041560F1DB824D4E87A003E1073F7EAD?method=download&shareKey=fcd58cf2ef2b4c2f743b7d3bf678d197)
  
### 所以，红黑树的另一种定义是满足下列条件的二叉查找树
* ⑴红链接均为左链接。
* ⑵没有任何一个结点同时和两条红链接相连。(这样会出现4-节点)
* ⑶该树是完美黑色平衡的，即任意空链接到根结点的路径上的黑链接数量相同
  
  
  







